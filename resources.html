<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Additional Resources – BSA COPE & Climbing</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header id="main-nav"></header>

    <main class="container">
      <h1 id="topic-title">Additional Resources</h1>
      <p class="section-lead" id="topic-desc"></p>

      <div id="resources-list"></div>

      <button
        class="btn ghost"
        onclick="window.location.href='classTopics.html'"
      >
        ← Back to Class Topics
      </button>
    </main>

    <script src="navbar.js"></script>
    <script>
      var params = new URLSearchParams(window.location.search);
      var topicId = params.get("topic");

      fetch("data.json")
        .then(function (res) {
          return res.json();
        })
        .then(function (data) {
          var topics = data.topics || [];
          var topic = null;

          for (var i = 0; i < topics.length; i++) {
            if (topics[i].id === topicId) {
              topic = topics[i];
              break;
            }
          }

          var titleEl = document.getElementById("topic-title");
          var descEl = document.getElementById("topic-desc");
          var listEl = document.getElementById("resources-list");

          if (!topic) {
            titleEl.textContent = "Topic not found";
            descEl.textContent =
              "Please go back to Class Topics and choose a topic again.";
            return;
          }

          titleEl.textContent = topic.title + " – Additional Resources";
          descEl.textContent = topic.description;

          var resources = topic.resources || [];

          if (!resources.length) {
            listEl.innerHTML =
              "<p>No additional resources have been added yet.</p>";
            return;
          }

          // Build list of links
          var ul = document.createElement("ul");

          resources.forEach(function (r, index) {
            var li = document.createElement("li");
            var a = document.createElement("a");

            a.href = r.url;

            var text = r.label || "Resource " + (index + 1);
            a.textContent = text;

            a.title = r.url;

            a.target = "_blank";
            a.rel = "noopener noreferrer";

            li.appendChild(a);
            ul.appendChild(li);
          });

          listEl.appendChild(ul);
        })
        .catch(function (err) {
          console.error("Error loading data.json:", err);
          var listEl = document.getElementById("resources-list");
          listEl.textContent = "There was a problem loading the resources.";
        });
    </script>
  </body>
</html>
