<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Standard Details â€“ BSA COPE & Climbing</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header id="main-nav"></header>

    <main class="container">
      <h1 id="standard-title">Standard</h1>
      <p id="standard-description" class="section-lead"></p>

      <section>
        <h2>Resources</h2>
        <div id="standard-resources"></div>
      </section>

      <div style="margin-top: 2rem">
        <a href="standards.html" class="btn ghost">
          &larr; Back to Standards
        </a>
      </div>
    </main>

    <script src="navbar.js"></script>
    <script>
      fetch("data.json")
        .then(function (res) {
          return res.json();
        })
        .then(function (data) {
          var params = new URLSearchParams(window.location.search);
          var id = params.get("standard");

          var standards = data.standards || [];
          var standard = standards.find(function (s) {
            return s.id === id;
          });

          var titleEl = document.getElementById("standard-title");
          var descEl = document.getElementById("standard-description");
          var resourcesContainer =
            document.getElementById("standard-resources");

          if (!standard) {
            titleEl.textContent = "Standard not found";
            descEl.textContent =
              "We couldn't find details for that standard. Please go back and try again.";
            return;
          }

          titleEl.textContent = standard.title;
          descEl.textContent = standard.description;

          if (
            Array.isArray(standard.resources) &&
            standard.resources.length > 0
          ) {
            var list = document.createElement("ul");
            list.className = "resource-list";

            standard.resources.forEach(function (res) {
              var li = document.createElement("li");
              var a = document.createElement("a");
              a.href = res.url;
              a.target = "_blank";
              a.rel = "noopener noreferrer";
              a.textContent = res.label;
              li.appendChild(a);
              list.appendChild(li);
            });

            resourcesContainer.appendChild(list);
          } else if (standard.link) {
            var p = document.createElement("p");
            var a = document.createElement("a");
            a.href = standard.link;
            a.target = "_blank";
            a.rel = "noopener noreferrer";
            a.textContent = "Open standard";
            p.appendChild(a);
            resourcesContainer.appendChild(p);
          } else {
            resourcesContainer.textContent = "No resources listed yet.";
          }
        })
        .catch(function (err) {
          console.error("Error loading standard details:", err);
          document.getElementById("standard-title").textContent =
            "Error loading standard";
          document.getElementById("standard-description").textContent =
            "There was a problem loading this standard's details.";
        });
    </script>
  </body>
</html>
